#Roberto Prieto 7/8/21 V2
#flights test data file
ftd = pd.read_csv('flights_test_size.csv')
#flights only from Atlanta
ftd = ftd[ftd['ORIGIN_AIRPORT'] == 'ATL']
ftd.reset_index(drop=True,inplace = True)
#filling in null delay values with 0.0
ftd['DEPARTURE_DELAY'].fillna(value=0.0,inplace = True)
ftd['ARRIVAL_DELAY'].fillna(value=0.0,inplace = True)
ftd['AIR_SYSTEM_DELAY'].fillna(value=0.0,inplace = True)
ftd['SECURITY_DELAY'].fillna(value=0.0,inplace = True)
ftd['AIRLINE_DELAY'].fillna(value=0.0,inplace = True)
ftd['LATE_AIRCRAFT_DELAY'].fillna(value=0.0,inplace = True)
ftd['WEATHER_DELAY'].fillna(value=0.0,inplace = True)
#including mean delay values in the titles of the delay columns
ftd.columns = ('YEAR','MONTH','DAY','DAY_OF_WEEK','AIRLINE','FLIGHT_NUMBER','TAIL_NUMBER','ORIGIN_AIRPORT','DESTINATION_AIRPORT','SCHEDULED_DEPARTURE','DEPARTURE_TIME','DEPARTURE_DELAY(Mean:'+str(ftd['DEPARTURE_DELAY'].mean())+')','TAXI_OUT','WHEELS_OFF','SCHEDULED_TIME','AIR_TIME','DISTANCE','WHEELS_ON','TAXI_IN','SCHEDULED_ARRIVAL','ARRIVAL_TIME','ARRIVAL_DELAY(Mean:'+str(ftd['ARRIVAL_DELAY'].mean())+')','DIVERTED','CANCELLED','CANCELLATION_REASON','AIR_SYSTEM_DELAY(Mean:'+str(ftd['AIR_SYSTEM_DELAY'].mean())+')','SECURITY_DELAY(Mean:'+str(ftd['SECURITY_DELAY'].mean())+')','AIRLINE_DELAY(Mean:'+str(ftd['AIRLINE_DELAY'].mean())+')','LATE_AIRCRAFT_DELAY(Mean:'+str(ftd['LATE_AIRCRAFT_DELAY'].mean())+')','WEATHER_DELAY(Mean:'+str(ftd['WEATHER_DELAY'].mean())+')')
ftd.to_excel('Atlanta_flights_test_size.xlsx',sheet_name='sheet1')
